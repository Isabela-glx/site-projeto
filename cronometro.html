<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cronômetro</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <video class="video-background" autoplay muted loop>
        <source src="assets/video.mp4" type="video/mp4">
    </video>
    
    <audio id="musica" loop>
        <source id="musicaSource" type="audio/mpeg">
    </audio>
    
    <audio id="avisoSom">
        <source src="assets/aviso.mp3" type="audio/mpeg">
    </audio>

    <div class="cronometro-container">
        <h1 id="cronometro">00:00</h1>
        <div class="control-container">
            <button class="botao" onclick="iniciarCronometro()">Iniciar</button>
            <button class="botao" onclick="pararCronometro()">Parar</button>
            <button class="botao" onclick="reiniciarCronometro()">Reiniciar</button>
            <button class="botao" onclick="toggleMusica()">Música</button>
        </div>
    </div>

    <script>
        let params = new URLSearchParams(window.location.search);
        let tempoTotal = params.get('tempo') * 60;
        let segundosRestantes = tempoTotal;
        let aviso1 = params.get('aviso1');
        let aviso2 = params.get('aviso2');
        let musicaSelecionada = params.get('musica');
        let intervalo;

        let musica = document.getElementById("musica");
        document.getElementById("musicaSource").src = `assets/${musicaSelecionada}`;
        musica.load();

        function tocarAviso() {
            document.getElementById('avisoSom').play();
        }

        function atualizarCronometro() {
            let minutos = Math.floor(segundosRestantes / 60);
            let segundos = segundosRestantes % 60;
            document.getElementById('cronometro').textContent = 
                (minutos < 10 ? "0" : "") + minutos + ":" + (segundos < 10 ? "0" : "") + segundos;
            
            if (segundosRestantes == aviso1 || segundosRestantes == aviso2) {
                tocarAviso();
            }
            
            if (segundosRestantes > 0) {
                segundosRestantes--;
            } else {
                clearInterval(intervalo);
            }
        }

        function iniciarCronometro() {
            if (!intervalo) {
                intervalo = setInterval(atualizarCronometro, 1000);
            }
        }

        function pararCronometro() {
            clearInterval(intervalo);
            intervalo = null;
        }

        function reiniciarCronometro() {
            pararCronometro();
            segundosRestantes = tempoTotal;
            atualizarCronometro();
        }

        function toggleMusica() {
            if (musica.paused) {
                musica.play();
            } else {
                musica.pause();
            }
        }

        atualizarCronometro();
    </script>
</body>
</html>
